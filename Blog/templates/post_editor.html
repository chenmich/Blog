{%extends 'base_for_blog.html'%}

{%block styles%}
    {{super()}}
    <link rel="stylesheet" href="/static/editor.md/css/editormd.min.css" />
{%endblock styles%}
{%block head%}
    {{super()}}
    <script type=text/javascript>
        $SCRIPT_ROOT = {{ request.script_root|tojson|safe }};
        $POST_URL = $SCRIPT_ROOT  + '/editor' + '/{{post_title}}'
    </script>
    
{%endblock head%}
{%block metas%}
    {{super()}}
    <meta charset="utf-8" />    
{%endblock metas%}

{%block content%}
<div class='container-fluid'>
    <div id='webstorage-message'>
            <P>你的web浏览器不支持web存储！我们每5分钟会把你的文档上传到服务器</p>
            <p>但可能会因为网络故障等等不可预期的原因导致文档不能及时上传，如果浏览器关闭或故障，会导致你的文档内容损失！<p>
            <p>建议你使用能支持web存储的浏览器</p>
            <p>这个<a href='http://dev-test.nemikor.com/web-storage/support-test/' target="_blank">网页</a>可以测试你的浏览器支持存储的能力</p>
    </div>
    <div class='col-sm-12'>
            <div id="post">
                <textarea form='editor' class="editormd-markdown-textarea" name="post-markdown-doc"></textarea>                
            </div>
            <input class='btn btn-primary' type='button' value='存储' id='save-document'/>    
    <div class='col-sm-1'>
        
    </div>

</div>

{%endblock content%}

{%block scripts%}
    {{super()}}
    <script type="text/javascript">
        var csrf_token = "{{ csrf_token() }}";    
        $.ajaxSetup({
            beforeSend: function(xhr, settings) {
                if (!/^(GET|HEAD|OPTIONS|TRACE)$/i.test(settings.type) && !this.crossDomain) {
                    xhr.setRequestHeader("X-CSRFToken", csrf_token);
                }
            }
        });
    </script>
    <script type='text/javascript' src="/static/editor.md/editormd.js"></script>
    <script type='text/javascript' src="/static/editor/editor.js"></script>
{%endblock scripts%}
